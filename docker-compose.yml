services:
  appchain:
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - ./test_consenus:/test_consenus:ro   # ðŸ‘ˆ Ð¢Ð¾Ð»ÑŒÐºÐ¾ Ñ‡Ñ‚ÐµÐ½Ð¸Ðµ
      - ./test_consenus_app:/test_consenus_app  # ðŸ‘ˆ ÐŸÐ¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ read-write
    ports:
      - "50051:50051"
      - "8080:8080"
    depends_on:
      - consensusnode
    command:
      - --emitter-port=:50051
      - --db-path=/test_consenus_app/db
      - --local-db-path=/test_consenus_app/tmpdb
      - --stream-dir=/test_consenus/snapshot.data
      - --rpc-port=:8080

  consensusnode:
    image: b00ris/consensusnode:latest
    volumes:
      - ./test_consenus:/test_consenus  # ðŸ‘ˆ ÐŸÐ¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ read-write
    command:
      - --snapshot-dir=/test_consenus
      - --appchain=1=appchain:50051
